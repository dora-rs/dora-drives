nodes:
  - id: oasis_agent
    custom:
      inputs:
        control: pid_control_op/control
        tick: dora/timer/secs/1
      outputs:
        - position
        - speed
        - image
        - objective_waypoints
        - lidar_pc
        - opendrive
      source: shell
      args: >
        python3 $SIMULATE --output 
        --oasJson --criteriaConfig $CRITERIA
        --openscenario $XOSC
        --agent $TEAM_AGENT
        --agentConfig $TEAM_AGENT_CONF
        --destination $DESTINATION
  
  - id: carla_gps_op
    operator:
      python: ../../carla/carla_gps_op.py
      outputs:
        - gps_waypoints
      inputs:
        opendrive: oasis_agent/opendrive
        objective_waypoints: oasis_agent/objective_waypoints
        position: oasis_agent/position
 
  - id: pid_control_op
    operator:
      python: ../../operators/pid_control_op.py
      outputs:
        - control
      inputs:
        position: oasis_agent/position
        speed: oasis_agent/speed
        waypoints: carla_gps_op/waypoints

  - id: plot
    operator:
      python: ../../operators/plot.py
      inputs:
        image: oasis_agent/image
        obstacles_bbox: yolov5/bbox
        gps_waypoints: carla_gps_op/gps_waypoints
        position: oasis_agent/position
        control: pid_control_op/control